(function(){/*
 http://pcjs.org/modules/shared/lib/dumpapi.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/reportapi.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/strlib.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/weblib.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/embed.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/defines.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/usrlib.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/shared/lib/component.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/defines.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/panel.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/cpu.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/rom.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/ram.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/keyboard.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/video.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/serial.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/disk.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/debugger.js (C) Jeff Parsons 2012-2017
 http://pcjs.org/modules/c1pjs/lib/computer.js (C) Jeff Parsons 2012-2017
*/
var f,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var ea={Jb:!0},fa={};try{fa.__proto__=ea;ca=fa.Jb;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ha=ba;
function p(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ha)ha(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Te=b.prototype}
for(var ia="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},q="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,ja=["Math","trunc"],ka=0;ka<ja.length-1;ka++){var la=ja[ka];la in q||(q[la]={});q=q[la]}
var ma=ja[ja.length-1],na=q[ma],oa=na?na:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b};oa!=na&&null!=oa&&ia(q,ma,{configurable:!0,writable:!0,value:oa});
function r(a,b,c){b?9<b&&(b=9):(b=Math.abs(a),b=65535>=b?4:4294967295>=b?8:9);c=c?"0x":"";var d=void 0===d?0:d;var e="";isNaN(a)?a=null:null!=a&&(0>a&&-1<a&&(a=-1),0>a&&(a+=Math.pow(16,b)),a>=Math.pow(16,b)&&(b=Math.ceil(Math.log(a)/Math.log(16))));for(var g=d||-1;0<b--;){g||(e=","+e,g=d);if(null==a)e="?"+e;else{var k=a%16;k+=0<=k&&9>=k?48:55;e=String.fromCharCode(k)+e;a=Math.trunc(a/16)}g--}return(void 0===c?"":c)+e}function u(a){return r(a,2,!0)}function w(a){return r(a,4,!0)}
function pa(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("\x26");0<c&&(b=b.substr(0,c));return b}function qa(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function ra(a){return a.replace(/[&<>"']/g,function(a){return sa[a]})}var sa={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#039;"},ta=Date.now||function(){return+new Date};
function x(a,b){var c=!0;c=void 0===c?!1:c;var d=0,e=null;if("object"==typeof resources&&(e=resources[a]))b&&b(a,e,d);else if(c&&"function"==typeof resources)resources(a,function(c,d){b&&b(a,c,d)});else{var g=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(g.onreadystatechange=function(){4===g.readyState&&(e=g.responseText,200==g.status||!g.status&&e.length&&"file:"==(window?window.location.protocol:"file:")||(d=g.status||-1),b&&b(a,e,d))});g.open("GET",
a,c);g.send();c||(e=g.responseText,200!=g.status&&(d=g.status||-1),b&&b(a,e,d))}}function y(a){if(window){var b=window?window.navigator.userAgent:"";return"iOS"==a&&!!b.match(/(iPod|iPhone|iPad)/)&&!!b.match(/AppleWebKit/)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function ua(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}
function va(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,g=!1;a.onmousedown=function(){g||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);g=!0}}function wa(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function z(a){A.init.push(a)}
function xa(a){if(ya)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){B(""+("An unexpected exception occurred:\n\n"+c.message+"\n\nPlease send this information to support@pcjs.org. Thanks."))}}function C(a){!ya&&a?(ya=!0,za&&Aa("init"),Ba&&Aa("show")):ya=a}function Aa(a){A[a]&&xa(A[a])}var Ca=null,A={init:[],show:[],exit:[]},za=!1,Ba=!1,ya=!0;wa("onload",function(){za=!0;xa(A.init)});wa("onpageshow",function(){Ba=!0;xa(A.show)});wa(y("iOS")?"onpagehide":y("Opera")?"onunload":"onbeforeunload",function(){xa(A.exit)});
function D(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.exports={};this.H=this.bindings={};a=this.id.indexOf(".");0>a||(this.kb=this.id.substr(0,a));this.C={ready:!1,Ga:!1,$a:!1,Se:!1,N:!1,Oe:!1,error:!1};this.bb=null;this.C.error=!1;this.la=c||0;this.u=this.s=this.U=null;E.push(this)}function B(a){window&&window.alert(a)}function Da(a,b){a.value+=b;b=a.value;8192<b.length&&(a.value=b.substr(b.length-4096));a.scrollTop=a.scrollHeight}
function F(a,b){b=G(b.parentNode,"c1pjs-control");for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var g=d[e];if(1===g.nodeType){var k=g.getAttribute("class");if(k)for(var l=k.split(" "),h=0;h<l.length;h++)switch(k=l[h],k){case "c1pjs-binding":(k=H(g))&&k.binding&&a.T(k.type,k.binding,g,k.value),h=l.length}}}}function Ea(a,b){if(void 0!==a){var c;b&&0<(c=b.indexOf("."))&&(a=b.substr(0,c+1)+a);for(c=0;c<E.length;c++)if(E[c].id===a)return E[c]}return null}
function Fa(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<E.length;d++)if(c)c==E[d]&&(c=null);else if(!(a!=E[d].type||b&&E[d].id.indexOf(b)))return E[d]}return null}function H(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){B(c.message+" ("+a+")")}return b}
function G(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
function Ga(a){for(var b=!0,c=I[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0],g=null;0<=Ha.indexOf(e)&&(g=function(){return function(){Ga(a)}}());var k=Ia[e];if(k)if(!g)b=k(d[1],d[2],d[3]);else{if(!k(g,d[1],d[2],d[3]))break}else{b=!1;var l=Fa(d[1],a);if(l)if(k=Ja[e])b=k(l,d[2],d[3]);else{var h=l.exports;if(h&&(k=h[e]))if(b=!0,!g)b=k.call(l,d[2],d[3]);else if(!k.call(l,g,d[2],d[3]))break}}if(!b){B("Script error: '"+e+(k?" failed":" unrecognized"));break}}c&&!c.length&&delete I[a];return b}f=D.prototype;
f.toString=function(){return this.name?this.name:this.id||this.type};
f.T=function(a,b,c){switch(b){case "clear":return this.H[b]||(this.H[b]=c,c.onclick=function(a){return function(){a.H.print&&(a.H.print.value="")}}(this)),!0;case "print":return this.H[b]||(this.H[b]=c,this.Va=function(a){this.l(a,this.type);return!0},c.value="",this.print=function(a){return function(b){Da(a,b)}}(c),this.l=function(a,b){return function(a,c){a||(a="");if(c!=Ka||"..."!=a.slice(-3))c&&(a=c+": "+a),Da(b,a+"\n");else{c=b.value;var d=c.lastIndexOf(a);0>d?c+=a+"\n":c=c.substr(0,d)+(a+".")+
c.substr(d+a.length);8192<c.length&&(c=c.substr(c.length-4096));b.value=c;b.scrollTop=b.scrollHeight}}}(this,c)),!0;default:return!1}};f.log=function(){};f.print=function(){};f.l=function(){};f.status=function(a){this.l(this.type+": "+a)};f.Va=function(a,b,c){if(!b){var d=Fa("Computer",this.id);if(d&&d.C.Oe)return console.log("ignoring notice during unload: "+a),!1}c=c||this.type;b||B((c?c+": ":"")+a);return!0};function La(a,b){a.C.error=!0;a.Va(b)}
function J(a,b){b&&(a.C.ready?b():a.bb=b);return a.C.ready}f.W=function(){if(!this.C.error&&(this.C.ready=!0,this.C.ready)){var a=this.bb;this.bb=null;a&&a()}};function K(a,b){a.C.Ga&&(b?a.C.$a=!0:void 0===b&&a.l(a.toString()+" busy"));return a.C.Ga}function L(a,b){if(a.C.$a)return a.C.Ga=!1,a.C.$a=!1;if(a.C.error)return a.l(a.toString()+" error"),!1;a.C.Ga=b;return a.C.Ga}function M(a,b){b=void 0===b?0:b;if(a.u){a!==a.u&&(b=b||a.la);var c=a.u.la&b;return!!b&&c===b||!!(c&a.u.Qe)}return!1}var Ka="progress";
window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]),window.PCjs.Commands||(window.PCjs.Commands={}));
var N=window?window.PCjs.Machines:{},E=window?window.PCjs.Components:[],I=window?window.PCjs.Commands:{},Ha=["hold","sleep","wait"],Ia={alert:function(a){B(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},Ja={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});function Ma(a){D.call(this,"C1PPanel",a);this.C.N=!1}p(Ma,D);
Ma.prototype.T=function(a,b,c,d){return this.U&&this.U.T(a,b,c,d)||this.s&&this.s.T(a,b,c,d)||this.b&&this.b.T(a,b,c,d)||this.u&&this.u.T(a,b,c,d)?!0:D.prototype.T.call(this,a,b,c,d)};Ma.prototype.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.U=b,this.s=O(b,"cpu"),this.b=O(b,"keyboard"),this.u=O(b,"debugger"),Na())};function Na(){for(var a=!1,b=G(document,"c1pjs","panel"),c=0;c<b.length;c++){var d=b[c],e=H(d),g=Ea(e.id);g||(a=!0,g=new Ma(e));F(g,d);a&&g.W()}}z(Na);
function Oa(a){D.call(this,"C1PCPU",a);Pa(this);this.C.N=!1;this.C.na=!1;this.Ta=a.autoStart;this.Oa=0;this.Me=1;this.Ne=2;this.speed=this.Oa;this.Ka=30;this.Ia=5;this.Ea=8;this.Sa=["Slow","Fast","Max"];this.gb=["(1Mhz)","(up to "+this.Ea+"Mhz)","(unlimited)"];this.P=[];this.J=[];this.pa=65536;this.qa=0;this.ea=65536;this.fa=0;this.Na=32;this.Za=2;this.Ke=1;this.o=[this.rc,this.Ld,this.Ce,this.m,this.m,this.Nd,this.hc,this.m,this.Qd,this.Kd,this.gc,this.m,this.m,this.Hd,this.ec,this.m,this.qc,this.Md,
this.m,this.m,this.m,this.Od,this.ic,this.m,this.uc,this.Jd,this.m,this.m,this.m,this.Id,this.fc,this.m,this.hd,this.ac,this.m,this.m,this.nc,this.cc,this.Wd,this.m,this.Sd,this.$b,this.Vd,this.m,this.mc,this.Xb,this.Td,this.m,this.oc,this.bc,this.m,this.m,this.m,this.dc,this.Xd,this.m,this.me,this.Zb,this.m,this.m,this.m,this.Yb,this.Ud,this.m,this.ce,this.Wc,this.m,this.m,this.m,this.Yc,this.Ed,this.m,this.Pd,this.Vc,this.Dd,this.m,this.gd,this.Sc,this.Bd,this.m,this.sc,this.Xc,this.m,this.m,this.m,
this.Zc,this.Fd,this.m,this.wc,this.Uc,this.m,this.m,this.m,this.Tc,this.Cd,this.m,this.de,this.qb,this.m,this.m,this.m,this.sb,this.ae,this.m,this.Rd,this.pb,this.$d,this.m,this.fd,this.mb,this.Yd,this.m,this.tc,this.rb,this.m,this.m,this.m,this.tb,this.be,this.m,this.oe,this.ob,this.m,this.m,this.m,this.nb,this.Zd,this.m,this.m,this.se,this.m,this.m,this.Ae,this.ue,this.xe,this.m,this.Rc,this.m,this.Ge,this.m,this.ze,this.pe,this.we,this.m,this.jc,this.te,this.m,this.m,this.Be,this.ve,this.ye,this.m,
this.Ie,this.re,this.He,this.m,this.m,this.qe,this.m,this.m,this.yd,this.nd,this.td,this.m,this.zd,this.pd,this.ud,this.m,this.Ee,this.md,this.De,this.m,this.wd,this.jd,this.rd,this.m,this.kc,this.od,this.m,this.m,this.Ad,this.qd,this.vd,this.m,this.xc,this.ld,this.Fe,this.m,this.xd,this.kd,this.sd,this.m,this.Kc,this.Cc,this.m,this.m,this.Lc,this.Ec,this.Oc,this.m,this.ed,this.Bc,this.Qc,this.m,this.Jc,this.yc,this.Mc,this.m,this.pc,this.Dc,this.m,this.m,this.m,this.Fc,this.Pc,this.m,this.vc,this.Ac,
this.m,this.m,this.m,this.zc,this.Nc,this.m,this.Hc,this.yb,this.m,this.m,this.Ic,this.Ab,this.bd,this.m,this.dd,this.xb,this.Gd,this.m,this.Gc,this.ub,this.$c,this.m,this.lc,this.zb,this.m,this.m,this.m,this.Bb,this.cd,this.m,this.ne,this.wb,this.m,this.m,this.m,this.vb,this.ad,this.m];this.fb=[7,6,0,0,0,3,5,0,3,2,2,0,0,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0,3,6,0,0,3,3,5,0,4,2,2,0,4,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0,6,6,0,0,0,3,5,0,3,2,2,0,3,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0,6,6,0,0,0,3,
5,0,4,2,2,0,5,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0,0,6,0,0,3,3,3,0,2,0,2,0,4,4,4,0,2,5,0,0,4,4,4,0,2,4,2,0,0,4,0,0,2,6,2,0,3,3,3,0,2,2,2,0,4,4,4,0,2,5,0,0,4,4,4,0,2,4,2,0,4,4,4,0,2,6,0,0,3,3,5,0,2,2,2,0,4,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0,2,6,0,0,3,3,5,0,2,2,2,0,4,4,6,0,2,5,0,0,0,4,6,0,2,4,0,0,0,4,7,0]}p(Oa,D);f=Oa.prototype;
f.reset=function(a){this.C.na&&this.aa();Pa(this);this.f=this.a[65532]|this.a[65533]<<8;this.C.error=!1;this.u?this.u.reset():a&&(!0===this.Ta||null===this.Ta&&!this.u&&void 0===this.H.run)&&this.ua()};
f.T=function(a,b,c){a=!1;switch(b){case "run":this.H[b]=c;c.onclick=function(a){return function(){a.C.na?a.aa():a.ua()}}(this);a=!0;break;case "A":case "X":case "Y":case "S":case "PC":case "C":case "Z":case "I":case "D":case "B":case "V":case "N":case "speed":this.H[b]=c;a=!0;break;case "setSpeed":this.H[b]=c,c.onclick=function(a){return function(){P(a,2<=a.speed?a.Oa:a.speed+1,!0)}}(this),a=!0}return a};
f.ba=function(a,b,c){this.a=a;this.M=b;this.ra=c-b+1;this.Ca=this.M+this.ra;this.M?B("unsupported CPU address buffer offset ("+this.M+")"):this.W()};f.ia=function(a,b){if(a&&!this.C.N){this.U=b;(this.u=O(b,"debugger"))&&this.u.Nb();if(a=O(b,"video"))this.ab=function(a){return function(){Qa(a)}}(a),this.ca=function(a){return function(){a.ca()}}(a);this.C.N=!0;this.reset(!0);this.update()}};function Ra(a,b,c,d,e){0>Sa(a.P,b,c,d,e)&&(a.pa>b&&(a.pa=b),a.qa<c&&(a.qa=c),a.P.push([b,c,d,e]))}
function Ta(a,b,c){for(var d=0;d<a.P.length;d++)b>=a.P[d][0]&&b<=a.P[d][1]&&a.P[d][3].call(a.P[d][2],b,c)}function Q(a,b,c,d,e){0>Sa(a.J,b,c,d,e)&&(a.ea>b&&(a.ea=b),a.fa<c&&(a.fa=c),a.J.push([b,c,d,e]))}function Ua(a,b,c){for(var d=0;d<a.J.length;d++)b>=a.J[d][0]&&b<=a.J[d][1]&&a.J[d][3].call(a.J[d][2],b,c)}function Sa(a,b,c,d,e){for(var g=0;g<a.length;g++)if(a[g][0]==b&&a[g][1]==c&&a[g][2]==d&&a[g][3]==e)return g;return-1}
function P(a,b,c){void 0!==b&&(a.speed=b,a.H.setSpeed&&(a.H.setSpeed.innerHTML=a.Sa[2<=b?0:b+1]),a.l("running at "+a.Sa[b].toLowerCase()+" speed "+a.gb[b]),c&&a.ca());a.V=0;a.Ua=ta();Va(a)}f.ab=function(){};f.ca=function(){};function R(a,b,c,d){void 0!==a.H[b]&&(void 0===d&&(d=1),c="0000"+c.toString(16),a.H[b].innerHTML=c.slice(c.length-d).toUpperCase())}
function Wa(a){R(a,"A",a.h,2);R(a,"X",a.w,2);R(a,"Y",a.F,2);var b=Xa(a);R(a,"C",b&1?1:0);R(a,"Z",b&2?1:0);R(a,"I",b&4?1:0);R(a,"D",b&8?1:0);R(a,"B",b&16?1:0);R(a,"V",b&64?1:0);R(a,"N",b&128?1:0);R(a,"S",a.G,4);R(a,"PC",a.f,4);a.H.speed&&a.K&&(a.H.speed.innerHTML=a.K.toFixed(1)+"Mhz")}
function Va(a,b){var c=30;c<a.Ka&&(c=a.Ka);c<a.Ia&&(c=a.Ia);var d=1;b&&a.speed>a.Oa&&a.K&&(d=a.K);d>a.Ea&&2>a.speed&&(d=a.Ea);a.hb=Math.round(1E3/30);a.ja=Math.floor(1E6/c*d);a.sa=Math.floor(1E6/30*d);a.Xa=Math.floor(1E6/a.Ka*d);a.Wa=Math.floor(1E6/a.Ia*d);b||(a.R=a.sa,a.Z=a.Xa,a.X=a.Wa);a.Ha=0}
function Ya(a){var b=ta(),c=a.hb;a.$&&(c=Math.round(c*a.$/a.sa));c-=b-a.Pe;if(b-=a.Ua)a.K=Math.round(a.V/(100*b))/10,864E5<=b&&P(a);0>c?c=0:1==a.speed?a.K<=a.Ea&&(c=0):2==a.speed&&(c=0);a.Ha+=a.$;return c}
f.ua=function(){if(L(this,!0)){this.C.na||(P(this),this.U&&this.U.start(),this.C.na=!0,this.H.run&&(this.H.run.innerHTML="Halt"),this.ca());1E6<=this.Ha&&Va(this,!0);this.$=0;this.Pe=ta();try{do{this.step(this.ja);var a=this.L-this.D;this.V+=a;this.$+=a;this.L=this.D=0;this.Z-=this.ja;0>=this.Z&&(this.Z+=this.Xa,this.ab());this.X-=this.ja;0>=this.X&&(this.X+=this.Wa,Wa(this));this.R-=this.ja;if(0>=this.R){this.R+=this.sa;break}}while(this.C.na)}catch(b){this.aa();this.update();L(this,!1);La(this,
b.stack||b.message);return}setTimeout(function(a){return function(){a.ua()}}(this),Ya(this))}else this.update(),this.U&&this.U.stop(this.Ua,this.V)};
f.step=function(a){var b=!0;this.b=this.g=-1;var c;if(c=a&&this.u)c=this.u,c=0<c.oa.length||0<c.va.length||0<c.xa.length;this.L=this.D=a;do{a=this.a[this.f];var d;if(d=c){d=this.u;var e=a,g=!1;Za(d,this.f,d.oa,"exec")?g=!0:(d.L++,d.B[e][1]++,d.wa[d.Ja++]=d.s.f,d.Ja>=d.wa.length&&(d.Ja=0));d=!!g}if(d){b=void 0;this.aa();break}this.f++;this.o[a].call(this);if(0<=this.b){this.b>=this.pa&&this.b<=this.qa&&Ta(this,this.b,this.f);if(d=c)d=this.u,e=!1,Za(d,this.b,d.va,"read")&&(e=!0),d=!!e;if(d){b=!1;this.aa();
break}this.b=-1}else if(0<=this.g){this.g>=this.ea&&this.g<=this.fa&&Ua(this,this.g,this.f);if(d=c){d=this.u;e=this.g;g=this.a[this.g];var k=!1;(g&255)!=g&&(d.l("invalid value at "+w(e)+": "+g),k=!0);Za(d,e,d.xa,"write")&&(k=!0);d=!!k}if(d){b=!1;this.aa();break}this.g=-1}this.D-=this.fb[a]}while(0<this.D);return b};function $a(a){a.R=0;a.L-=a.D;a.D=0}f.aa=function(){K(this,!0);this.L-=this.D;this.D=0;this.C.na&&(this.C.na=!1,this.H.run&&(this.H.run.innerHTML="Run"))};
f.update=function(){this.ab();Wa(this)};function ab(a){return a.C.na?a.V+a.L-a.D:0}f.S=function(a){return this.a[a]};function Xa(a){var b=a.c&256?1:0;b|=a.j&255?0:2;b|=(a.v&255^a.A^a.v>>1)&128?64:0;b|=a.i&128?128:0;return a.B&60|b}function bb(a){a.B|=8;a.o[97]=a.Tb;a.o[101]=a.Vb;a.o[105]=a.Sb;a.o[109]=a.Pb;a.o[113]=a.Ub;a.o[117]=a.Wb;a.o[121]=a.Rb;a.o[125]=a.Qb;a.o[225]=a.ie;a.o[229]=a.ke;a.o[233]=a.he;a.o[237]=a.ee;a.o[241]=a.je;a.o[245]=a.le;a.o[249]=a.ge;a.o[253]=a.fe}
function cb(a){a.B&=-9;a.o[97]=a.qb;a.o[101]=a.sb;a.o[105]=a.pb;a.o[109]=a.mb;a.o[113]=a.rb;a.o[117]=a.tb;a.o[121]=a.ob;a.o[125]=a.nb;a.o[225]=a.yb;a.o[229]=a.Ab;a.o[233]=a.xb;a.o[237]=a.ub;a.o[241]=a.zb;a.o[245]=a.Bb;a.o[249]=a.wb;a.o[253]=a.vb}function S(a,b,c){var d=a.c&256?1:0,e=(b&15)+(c&15)+d;10<=e&&(e=e+6&15|16);e+=(b&240)+(c&240);a.A=b^c;a.v=e;a.i=e&255;160<=e&&(e+=96);512<=e&&(e-=256);a.c=e;a.j=b+c+d&255;a.D--;return e&255}
function T(a,b,c){var d=a.c&256?0:1,e=(b&15)-(c&15)-d;0>e&&(e=(e-6&15)-16);e+=(b&240)-(c&240);0>e&&(e-=96);a.i=a.j=(a.c=b-c-d)&255;a.A=b^c;a.v=a.c;a.c^=256;a.D--;return e&255}function Pa(a){a.h=0;a.w=0;a.F=0;a.G=256;a.B=0;a.i=0;a.j=0;a.A=0;a.v=0;a.c=0;a.f=0;a.b=-1;a.g=-1;a.K=0;a.V=a.L=a.D=0}
f.rc=function(){this.f++;this.a[this.G--]=this.f>>8;this.G|=256;this.a[this.G--]=this.f&255;this.G|=256;this.B|=16;this.B=Xa(this);this.a[this.G--]=this.B;this.G|=256;this.B&=239;this.b=65534;this.f=this.a[this.b]|this.a[this.b+1]<<8};f.Ld=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.i=this.j=this.h|=this.a[this.b]};f.Nd=function(){this.b=this.a[this.f++];this.i=this.j=this.h|=this.a[this.b]};
f.hc=function(){this.g=this.a[this.f++];this.c=this.a[this.g]<<1;this.i=this.j=this.a[this.g]=this.c&255};f.Qd=function(){this.B=Xa(this);this.a[this.G--]=this.B;this.G|=256};f.Kd=function(){this.b=this.f++;this.i=this.j=this.h|=this.a[this.b]};f.gc=function(){this.c=this.h<<1;this.i=this.j=this.h=this.c&255};f.Hd=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.h|=this.a[this.b]};
f.ec=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.a[this.g]<<1;this.i=this.j=this.a[this.g]=this.c&255};f.qc=function(){this.f+=(this.i&128?0:(this.D--,this.a[this.f]<<24>>24))+1};f.Md=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.i=this.j=this.h|=this.a[this.b]};f.Od=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.h|=this.a[this.b]};
f.ic=function(){this.g=this.a[this.f++]+this.w&255;this.c=this.a[this.g]<<1;this.i=this.j=this.a[this.g]=this.c&255};f.uc=function(){this.c=0};f.Jd=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.h|=this.a[this.b]};f.Id=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.h|=this.a[this.b]};f.fc=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.a[this.g]<<1;this.i=this.j=this.a[this.g]=this.c&255};
f.hd=function(){this.b=this.f++;this.a[this.G--]=this.f>>8;this.G|=256;this.a[this.G--]=this.f&255;this.G|=256;this.f=this.a[this.b]|this.a[this.b+1]<<8};f.ac=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.i=this.j=this.h&=this.a[this.b]};f.nc=function(){this.b=this.a[this.f++];this.j=this.h&this.a[this.b];this.i=this.i&127|this.a[this.b]&128;this.v=0;this.A=this.a[this.b]&64?128:0};f.cc=function(){this.b=this.a[this.f++];this.i=this.j=this.h&=this.a[this.b]};
f.Wd=function(){this.g=this.a[this.f++];this.c=this.c&65280|this.a[this.g];this.c<<=1;this.c=this.c&65534|(this.c&512?1:0);this.i=this.j=this.a[this.g]=this.c&255};f.Sd=function(){this.G=this.G+1&255|256;this.B=this.a[this.G];this.c=this.B&1?256:0;this.j=this.B&2?0:1;this.i=this.B&128;this.v=0;this.A=this.B&64?128:0};f.$b=function(){this.b=this.f++;this.i=this.j=this.h&=this.a[this.b]};
f.Vd=function(){this.c=this.c&65280|this.h;this.c<<=1;this.c=this.c&65534|(this.c&512?1:0);this.i=this.j=this.h=this.c&255};f.mc=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.j=this.h&this.a[this.b];this.i=this.i&127|this.a[this.b]&128;this.v=0;this.A=this.a[this.b]&64?128:0};f.Xb=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.h&=this.a[this.b]};
f.Td=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.c&65280|this.a[this.g];this.c<<=1;this.c=this.c&65534|(this.c&512?1:0);this.i=this.j=this.a[this.g]=this.c&255};f.oc=function(){this.f+=(this.i&128?(this.D--,this.a[this.f]<<24>>24):0)+1};f.bc=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.i=this.j=this.h&=this.a[this.b]};f.dc=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.h&=this.a[this.b]};
f.Xd=function(){this.g=this.a[this.f++]+this.w&255;this.c=this.c&65280|this.a[this.g];this.c<<=1;this.c=this.c&65534|(this.c&512?1:0);this.i=this.j=this.a[this.g]=this.c&255};f.me=function(){this.c=256};f.Zb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.h&=this.a[this.b]};f.Yb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.h&=this.a[this.b]};
f.Ud=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.c&65280|this.a[this.g];this.c<<=1;this.c=this.c&65534|(this.c&512?1:0);this.i=this.j=this.a[this.g]=this.c&255};f.ce=function(){this.G=this.G+1&255|256;this.B=this.a[this.G];this.c=this.B&1?256:0;this.j=this.B&2?0:1;this.i=this.B&128;this.v=0;this.A=this.B&64?128:0;this.G=this.G+2&255|256;this.f=this.a[this.G-1|256]|this.a[this.G]<<8};
f.Wc=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.i=this.j=this.h^=this.a[this.b]};f.Yc=function(){this.b=this.a[this.f++];this.i=this.j=this.h^=this.a[this.b]};f.Ed=function(){this.g=this.a[this.f++];this.c=this.c&65279|(this.a[this.g]&1?256:0);this.a[this.g]=(this.c=this.c&65280|this.a[this.g]>>1)&255;this.i=this.j=this.c&255};f.Pd=function(){this.a[this.G--]=this.h;this.G|=256};f.Vc=function(){this.b=this.f++;this.i=this.j=this.h^=this.a[this.b]};
f.Dd=function(){this.c=this.c&65279|(this.h&1?256:0);this.h=(this.c=this.c&65280|this.h>>1)&255;this.i=this.j=this.c&255};f.gd=function(){this.b=this.f;this.f=this.a[this.b]|this.a[this.b+1]<<8};f.Sc=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.h^=this.a[this.b]};f.Bd=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.c&65279|(this.a[this.g]&1?256:0);this.a[this.g]=(this.c=this.c&65280|this.a[this.g]>>1)&255;this.i=this.j=this.c&255};
f.sc=function(){this.f+=((this.v&255^this.A^this.v>>1)&128?0:(this.D--,this.a[this.f]<<24>>24))+1};f.Xc=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.i=this.j=this.h^=this.a[this.b]};f.Zc=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.h^=this.a[this.b]};f.Fd=function(){this.g=this.a[this.f++]+this.w&255;this.c=this.c&65279|(this.a[this.g]&1?256:0);this.a[this.g]=(this.c=this.c&65280|this.a[this.g]>>1)&255;this.i=this.j=this.c&255};
f.wc=function(){this.B&=251};f.Uc=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.h^=this.a[this.b]};f.Tc=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.h^=this.a[this.b]};f.Cd=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.c&65279|(this.a[this.g]&1?256:0);this.a[this.g]=(this.c=this.c&65280|this.a[this.g]>>1)&255;this.i=this.j=this.c&255};
f.de=function(){this.G=this.G+2&255|256;this.f=(this.a[this.G-1|256]|this.a[this.G]<<8)+1};f.qb=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Tb=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.h=S(this,this.h,this.a[this.b])};
f.sb=function(){this.b=this.a[this.f++];this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Vb=function(){this.b=this.a[this.f++];this.h=S(this,this.h,this.a[this.b])};f.ae=function(){this.g=this.a[this.f++];this.c=this.c&65280|this.a[this.g];this.c=this.c&65023|(this.c&1?512:0);this.c>>=1;this.i=this.j=this.a[this.g]=this.c&255};f.Rd=function(){this.G=this.G+1&255|256;this.i=this.j=this.h=this.a[this.G]};
f.pb=function(){this.b=this.f++;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Sb=function(){this.b=this.f++;this.h=S(this,this.h,this.a[this.b])};f.$d=function(){this.c=this.c&65280|this.h;this.c=this.c&65023|(this.c&1?512:0);this.c>>=1;this.i=this.j=this.h=this.c&255};f.fd=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.f=this.a[this.b]|this.a[this.b+1]<<8};
f.mb=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Pb=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.h=S(this,this.h,this.a[this.b])};f.Yd=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.c&65280|this.a[this.g];this.c=this.c&65023|(this.c&1?512:0);this.c>>=1;this.i=this.j=this.a[this.g]=this.c&255};
f.tc=function(){this.f+=((this.v&255^this.A^this.v>>1)&128?(this.D--,this.a[this.f]<<24>>24):0)+1};f.rb=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Ub=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.h=S(this,this.h,this.a[this.b])};
f.tb=function(){this.b=this.a[this.f++]+this.w&255;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Wb=function(){this.b=this.a[this.f++]+this.w&255;this.h=S(this,this.h,this.a[this.b])};f.be=function(){this.g=this.a[this.f++]+this.w&255;this.c=this.c&65280|this.a[this.g];this.c=this.c&65023|(this.c&1?512:0);this.c>>=1;this.i=this.j=this.a[this.g]=this.c&255};f.oe=function(){this.B|=4};
f.ob=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};f.Rb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.h=S(this,this.h,this.a[this.b])};f.nb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.h+this.a[this.b]+(this.c&256?1:0);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255};
f.Qb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.h=S(this,this.h,this.a[this.b])};f.Zd=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.c&65280|this.a[this.g];this.c=this.c&65023|(this.c&1?512:0);this.c>>=1;this.i=this.j=this.a[this.g]=this.c&255};f.se=function(){this.g=this.a[this.f++]+this.w&255;this.g=this.a[this.g]|this.a[this.g+1]<<8;this.a[this.g]=this.h};f.Ae=function(){this.g=this.a[this.f++];this.a[this.g]=this.F};
f.ue=function(){this.g=this.a[this.f++];this.a[this.g]=this.h};f.xe=function(){this.g=this.a[this.f++];this.a[this.g]=this.w};f.Rc=function(){this.i=this.j=this.F=this.F-1&255};f.Ge=function(){this.i=this.j=this.h=this.w};f.ze=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.a[this.g]=this.F};f.pe=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.a[this.g]=this.h};f.we=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.a[this.g]=this.w};
f.jc=function(){this.f+=(this.c&256?0:(this.D--,this.a[this.f]<<24>>24))+1};f.te=function(){this.g=this.a[this.f++];this.g=(this.a[this.g]|this.a[this.g+1]<<8)+this.F;this.a[this.g]=this.h};f.Be=function(){this.g=this.a[this.f++]+this.w&255;this.a[this.g]=this.F};f.ve=function(){this.g=this.a[this.f++]+this.w&255;this.a[this.g]=this.h};f.ye=function(){this.g=this.a[this.f++]+this.F&255;this.a[this.g]=this.w};f.Ie=function(){this.i=this.j=this.h=this.F};
f.re=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.a[this.g]=this.h};f.He=function(){this.G=this.w|256};f.qe=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.a[this.g]=this.h};f.yd=function(){this.b=this.f++;this.i=this.j=this.F=this.a[this.b]};f.nd=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.i=this.j=this.h=this.a[this.b]};f.td=function(){this.b=this.f++;this.i=this.j=this.w=this.a[this.b]};
f.zd=function(){this.b=this.a[this.f++];this.i=this.j=this.F=this.a[this.b]};f.pd=function(){this.b=this.a[this.f++];this.i=this.j=this.h=this.a[this.b]};f.ud=function(){this.b=this.a[this.f++];this.i=this.j=this.w=this.a[this.b]};f.Ee=function(){this.i=this.j=this.F=this.h};f.md=function(){this.b=this.f++;this.i=this.j=this.h=this.a[this.b]};f.De=function(){this.i=this.j=this.w=this.h};f.wd=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.F=this.a[this.b]};
f.jd=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.h=this.a[this.b]};f.rd=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.w=this.a[this.b]};f.kc=function(){this.f+=(this.c&256?(this.D--,this.a[this.f]<<24>>24):0)+1};f.od=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.i=this.j=this.h=this.a[this.b]};f.Ad=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.F=this.a[this.b]};
f.qd=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.h=this.a[this.b]};f.vd=function(){this.b=this.a[this.f++]+this.F&255;this.i=this.j=this.w=this.a[this.b]};f.xc=function(){this.A=this.v=0};f.ld=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.h=this.a[this.b]};f.Fe=function(){this.i=this.j=this.w=this.G&255};f.xd=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.F=this.a[this.b]};
f.kd=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.h=this.a[this.b]};f.sd=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.w=this.a[this.b]};f.Kc=function(){this.b=this.f++;this.i=this.j=this.c=this.F-this.a[this.b];this.c^=256};f.Cc=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};
f.Lc=function(){this.b=this.a[this.f++];this.i=this.j=this.c=this.F-this.a[this.b];this.c^=256};f.Ec=function(){this.b=this.a[this.f++];this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Oc=function(){this.g=this.a[this.f++];this.i=this.j=this.a[this.g]=this.a[this.g]-1&255};f.ed=function(){this.i=this.j=this.F=this.F+1&255};f.Bc=function(){this.b=this.f++;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Qc=function(){this.i=this.j=this.w=this.w-1&255};
f.Jc=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.c=this.F-this.a[this.b];this.c^=256};f.yc=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Mc=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.a[this.g]=this.a[this.g]-1&255};f.pc=function(){this.f+=(this.j&255?(this.D--,this.a[this.f]<<24>>24):0)+1};
f.Dc=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Fc=function(){this.b=this.a[this.f++]+this.w&255;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Pc=function(){this.g=this.a[this.f++]+this.w&255;this.i=this.j=this.a[this.g]=this.a[this.g]-1&255};f.vc=function(){cb(this)};
f.Ac=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.zc=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.c=this.h-this.a[this.b];this.c^=256};f.Nc=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.a[this.g]=this.a[this.g]-1&255};f.Hc=function(){this.b=this.f++;this.i=this.j=this.c=this.w-this.a[this.b];this.c^=256};
f.yb=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.ie=function(){this.b=this.a[this.f++]+this.w&255;this.b=this.a[this.b]|this.a[this.b+1]<<8;this.h=T(this,this.h,this.a[this.b])};f.Ic=function(){this.b=this.a[this.f++];this.i=this.j=this.c=this.w-this.a[this.b];this.c^=256};
f.Ab=function(){this.b=this.a[this.f++];this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.ke=function(){this.b=this.a[this.f++];this.h=T(this,this.h,this.a[this.b])};f.bd=function(){this.g=this.a[this.f++];this.i=this.j=this.a[this.g]=this.a[this.g]+1&255};f.dd=function(){this.i=this.j=this.w=this.w+1&255};
f.xb=function(){this.b=this.f++;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.he=function(){this.b=this.f++;this.h=T(this,this.h,this.a[this.b])};f.Gd=function(){};f.Gc=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.c=this.w-this.a[this.b];this.c^=256};
f.ub=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.ee=function(){this.b=this.a[this.f++]|this.a[this.f++]<<8;this.h=T(this,this.h,this.a[this.b])};f.$c=function(){this.g=this.a[this.f++]|this.a[this.f++]<<8;this.i=this.j=this.a[this.g]=this.a[this.g]+1&255};f.lc=function(){this.f+=(this.j&255?0:(this.D--,this.a[this.f]<<24>>24))+1};
f.zb=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.je=function(){this.b=this.a[this.f++];this.b=(this.a[this.b]|this.a[this.b+1]<<8)+this.F;this.h=T(this,this.h,this.a[this.b])};
f.Bb=function(){this.b=this.a[this.f++]+this.w&255;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.le=function(){this.b=this.a[this.f++]+this.w&255;this.h=T(this,this.h,this.a[this.b])};f.cd=function(){this.g=this.a[this.f++]+this.w&255;this.i=this.j=this.a[this.g]=this.a[this.g]+1&255};f.ne=function(){bb(this)};
f.wb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.ge=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.F;this.h=T(this,this.h,this.a[this.b])};
f.vb=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.c=this.h-this.a[this.b]-(this.c&256?0:1);this.A=this.h^this.a[this.b];this.v=this.c;this.i=this.j=this.h=this.c&255;this.c^=256};f.fe=function(){this.b=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.h=T(this,this.h,this.a[this.b])};f.ad=function(){this.g=(this.a[this.f++]|this.a[this.f++]<<8)+this.w;this.i=this.j=this.a[this.g]=this.a[this.g]+1&255};
f.Ce=function(){var a=this.a[this.f++];switch(a){case 0:this.l("HALT");this.aa();break;case 1:a=this.f;for(var b="";a<this.a.length;){var c=this.a[a++];if(!c)break;b+=String.fromCharCode(c)}this.f=a;b=b.replace(/%A/g,r(this.h,2)).replace(/%X/g,r(this.w,2)).replace(/%Y/g,r(this.F,2));this.l(b);$a(this);break;default:this.f-=2,this.l("undefined opSim: "+u(a)+" at "+w(this.f)),this.aa()}};f.m=function(){var a=this.a[--this.f];this.l("undefined opcode: "+u(a)+" at "+w(this.f));this.aa()};
z(function(){for(var a=G(document,"c1pjs","cpu"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new Oa(d);F(d,c)}});function db(a){D.call(this,"C1PROM",a);this.b=this.a=null;this.g=a.size;if(this.o=a.image){a=this.o;var b=qa(this.o);"json"!=b&&"hex"!=b&&(a="http://"+(window?window.location.host:"www.pcjs.org")+"/api/v1/dump?file\x3d"+this.o+"\x26format\x3dbytes");var c=this;x(a,function(a,b,g){eb(c,a,b,g)})}}p(db,D);
db.prototype.ba=function(a,b,c,d){this.a=a;this.v=b;a=c-b+1;this.g||(this.g=a);a!=this.g?La(this,"computer-specified ROM size ("+w(a)+") does not match component-specified size ("+w(this.g)+")"):(d&&(this.s=d,Q(d,b,c,this,this.A)),fb(this))};db.prototype.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.u=O(b,"debugger"))};db.prototype.A=function(a,b){void 0!==b&&(this.u&&U(this.u,this,a,b,this.u.jb,!0),a-=this.v,this.a[this.v+a]=this.b?this.b[a]:0)};
function eb(a,b,c,d){if(d)a.l('Error loading ROM "'+b+'" ('+d+")");else{if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),g=e.bytes;g?a.b=g:a.b=e}catch(k){a.l('Error processing ROM "'+b+'": '+k.message);return}else for(b=c.replace(/\n/gm," ").replace(/ +$/,"").split(" "),a.b=Array(b.length),c=0;c<b.length;c++)a.b[c]=parseInt(b[c],16);fb(a)}}
function fb(a){if(!J(a))if(!a.o)a.W();else if(a.b&&a.a){var b=a.b.length;if(b!=a.g)La(a,"ROM image size ("+w(b)+") does not match component-specified size ("+w(a.g)+")");else{for(var c=0;c<b;c++)a.a[a.v+c]=a.b[c];a.W()}}}z(function(){for(var a=G(document,"c1pjs","rom"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new db(d);F(d,c)}});function gb(a){D.call(this,"C1PRAM",a)}p(gb,D);gb.prototype.ba=function(a){this.a=a;this.W()};
z(function(){for(var a=G(document,"c1pjs","ram"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new gb(d);F(d,c)}});
function hb(a){D.call(this,"C1PKeyboard",a);this.C.N=!1;this.Ha=a.model;this.$=8;this.Xa=10;this.Wa=13;this.ea=27;this.Ta=this.$;this.Ua=this.Xa;this.Ia=this.Wa;this.Z=this.ea;this.K=241;this.X=224;this.Ka=3;this.Sa=15;this.J=1;this.D={};this.D["break"]=this.X;this.D.esc=this.Z;this.D["ctrl-c"]=this.Ka;this.D["ctrl-o"]=this.Sa;this.b=[];this.b[49]=30464;this.b[33]=30704;this.b[50]=30208;this.b[34]=30448;this.b[51]=29952;this.b[35]=30192;this.b[52]=29696;this.b[36]=29936;this.b[53]=29440;this.b[37]=
29680;this.b[54]=29184;this.b[38]=29424;this.b[55]=28928;this.b[39]=29168;this.b[56]=26368;this.b[40]=26608;this.b[57]=26112;this.b[41]=26352;this.b[48]=25856;this.b[58]=25600;this.b[42]=25840;this.b[45]=25344;this.b[61]=25584;this.b[46]=22272;this.b[62]=22512;this.b[108]=22016;this.b[76]=22256;this.b[92]=22256;this.b[111]=21760;this.b[79]=22E3;this.b[this.Ta]=22E3;this.b[this.Ua]=21504;this.b[this.Ia]=21248;this.b[119]=18176;this.b[87]=18416;this.b[101]=17920;this.b[69]=18160;this.b[114]=17664;this.b[82]=
17904;this.b[116]=17408;this.b[84]=17648;this.b[121]=17152;this.b[89]=17392;this.b[117]=16896;this.b[85]=17136;this.b[105]=16640;this.b[73]=16880;this.b[115]=14080;this.b[83]=14320;this.b[100]=13824;this.b[68]=14064;this.b[102]=13568;this.b[70]=13808;this.b[103]=13312;this.b[71]=13552;this.b[104]=13056;this.b[72]=13296;this.b[106]=12800;this.b[74]=13040;this.b[107]=12544;this.b[75]=12784;this.b[91]=12784;this.b[120]=9984;this.b[88]=10224;this.b[99]=9728;this.b[67]=9968;this.b[118]=9472;this.b[86]=
9712;this.b[98]=9216;this.b[66]=9456;this.b[110]=8960;this.b[78]=9200;this.b[94]=9200;this.b[109]=8704;this.b[77]=8944;this.b[93]=8944;this.b[44]=8448;this.b[60]=8688;this.b[113]=5888;this.b[81]=6128;this.b[97]=5632;this.b[65]=5872;this.b[122]=5376;this.b[90]=5616;this.b[32]=5120;this.b[47]=4864;this.b[63]=5104;this.b[59]=4608;this.b[43]=4848;this.b[112]=4352;this.b[80]=4592;this.b[64]=4592;this.b[this.K]=1536;this.b[this.Z]=1280;this.b[240]=512;this.b[242]=256;this.b[244]=0;this.reset()}p(hb,D);
f=hb.prototype;f.reset=function(){this.La(this.Ha);this.g=this.J;this.ja=0;this.o=[this.J,0,0,0,0,0,0,0];this.L=[];if(this.v)for(var a in this.v)isNaN(+a)||this.v[a]&&clearTimeout(this.v[a]);this.v=[];this.sa=this.A=0;this.pa=-1;this.fa=this.o;this.qa=this.V=0;this.B=""};
f.T=function(a,b,c){if(void 0===this.H[b])switch(b){case "keyDown":return this.H[b]=c,c.onkeydown=function(a){return function(b){return ib(a,b,!0)}}(this),!0;case "keyPress":return this.H[b]=c,c.onkeypress=function(a){return function(b){var c=!0;b=b||window.event;b=b.which||b.keyCode;a.B="";a.g&8?a.g&=-9:c=!jb(a,b);a.u&&M(a.u,a.u.ya)&&a.u.message("keyPress("+u(b)+"): "+(c?"pass":"consume"));return c}}(this),!0;case "keyUp":return this.H[b]=c,c.onkeyup=function(a){return function(b){return ib(a,b,
!1)}}(this),!0;case "break":return this.H[b]=c,c.onclick=function(a){return function(){a.U&&a.U.reset(!0)}}(this),!0;default:if(void 0!==this.D[b])return this.H[b]=c,c.onclick=function(a,b,c){return function(){a.s&&a.s.ca();return!jb(a,c)}}(this,b,this.D[b]),!0}return!1};f.ba=function(a,b,c,d){this.a=a;this.ra=b;this.fb=c-b+1;this.hb=this.ra+this.fb;d&&(this.s=d,Q(d,b,c,this,this.Gb));this.W()};f.La=function(a){this.M=a;this.P=255;600!=this.M&&(this.P=0,this.l("updated keyboard model: "+this.M))};
f.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.U=b,this.u=O(b,"debugger"))};f.W=function(){this.R=(this.gb=y("iOS"))||y("Android");this.u&&M(this.u,this.u.ya)&&this.u.message("mobile keyboard support: "+(this.R?"true":"false")+" ("+window.navigator.userAgent+")");D.prototype.W.call(this)};function kb(a,b){b=b?100:250;a.s&&a.s.K&&(b/=a.s.K);return b}function lb(a,b){!a.A||void 0!==b&&b==a.A||(a.u&&M(a.u,a.u.ya)&&a.u.message("autoClear("+u(a.A)+")"),clearTimeout(a.v[a.A]),mb(a,a.A,!1,4))}
function nb(a,b,c){a.B=b;ob(a,c||300)}function ob(a,b){if(0<a.B.length){var c=a.B.charCodeAt(0);10==c&&(c=13);65<=c&&90>=c&&(c+=32);a.B=a.B.substr(1);jb(a,c)}0<a.B.length&&setTimeout(function(a){return function(){ob(a,b)}}(a),b)}
function ib(a,b,c){var d=!c;b=b.keyCode;c&&(a.sa=b);if(16==b)a.g&=-5,c&&(a.g|=4),b+=224,d=!1;else if(18==b)a.g&=-3,c&&(a.g|=2),b+=224,d=!1;else if(b==a.K-224)a.g&=-65,c&&(a.g|=64),b+=224,d=!1;else if(20==b)c=!c,a.g&=~a.J,c&&(a.g|=a.J),b+=224,d=!1;else if(91==b){a.g&=-9;c&&(a.g|=8);d=!1;var e=!0}else e=9==b?d=!1:b==a.ea||b==a.$?c?!jb(a,b):!1:!0;d&&(a.g&=-9,a.R||b!=a.sa||lb(a));void 0===e&&(e=!mb(a,b,c,2));a.u&&M(a.u,a.u.ya)&&a.u.message("key"+(c?"Down":"Up")+"("+u(b)+"): "+(e?"pass":"consume"));return e}
function jb(a,b){var c=!1;b==a.X?a.U&&(a.U.reset(!0),c=!0):(a.R&&65<=b&&90>=b&&(b+=32),lb(a,b),mb(a,b,!0,0)&&(2==a.s.speed?mb(a,b,!1,1):(c=!1,a.v[b]&&(clearTimeout(a.v[b]),c=!0),c=kb(a,c),a.v[a.A=b]=setTimeout(function(a){return function(){mb(a,b,!1,3)}}(a),c),a.u&&M(a.u,a.u.ya)&&a.u.message("keyPressSimulate("+u(b)+"): setTimeout()")),c=!0));a.u&&M(a.u,a.u.ya)&&a.u.message("keyPressSimulate("+u(b)+"): "+(c?"true":"false"));return c}
function mb(a,b,c,d){var e=!1;c||(a.v[b]=null,a.A==b&&(a.A=0));var g=0,k=a.b[b];void 0===k&&(1<=b&&26>=b&&(b+=64,g=a.K),k=a.b[b]);void 0!==k&&(b=k>>12,e=k>>8&15,g||(g=k&255),c?(a.o[b]|=1<<e,a.o[0]=g==a.K?a.o[0]|64:240==g?a.o[0]|4:242==g?a.o[0]|2:a.o[0]&-71):(a.o[b]&=~(1<<e),a.o[0]&=-71,a.o[0]|=a.g&70),c=0==d&&!a.L.length,a.L.push(a.o.slice()),pb(a,c),e=!0);return e}f.S=function(){};f.Gb=function(a){this.ja=this.s.S(a)^this.P;this.V++;pb(this,!1,a)};
function pb(a,b,c){var d=ab(a.s);b||(2==a.s.speed?b=void 0!==c&&32<=a.V:(b=d-a.qa,b=0>b||8192<=b));b&&(b=a.L.shift(),void 0!==b&&(a.fa=b),a.V=0,a.qa=d);for(b=d=0;8>b;b++)a.ja&1<<b&&(d|=a.fa[b]);d^=a.P;if(void 0!==c)a.a[c]=d;else if(c=a.ra,d!=a.pa)for(;c<a.hb;c++)a.a[c]=d;a.pa=d}z(function(){for(var a=G(document,"c1pjs","keyboard"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new hb(d);F(d,c)}});
function qb(a,b,c,d){D.call(this,"C1PVideo",a);this.ja=a.model;this.$=a.charCols;this.ea=a.charRows;this.qa=a.screenWidth;this.ra=a.screenHeight;this.B=a.charWidth;this.D=a.charHeight;rb(this);this.A=b;this.P=c;this.o=d;var e;b=["","moz","ms","webkit"];a=a.smoothing;if(!Ca){c={};if(window){e||(e=window.location.search.substr(1));for(var g=/\+/g,k=/([^&=]+)=?([^&]*)/g;d=k.exec(e);)c[decodeURIComponent(d[1].replace(g," "))]=decodeURIComponent(d[2].replace(g," "))}Ca=c}(e=Ca.smoothing||Ca.smoothing)&&
(a="true"==e);if(null!=a)for(e=0;e<b.length;e++)if(c=(c=b[e])?c+"ImageSmoothingEnabled":"imageSmoothingEnabled",void 0!==this.P[c]){this.P[c]=a;break}}p(qb,D);f=qb.prototype;f.reset=function(a){this.La(this.ja);if(this.a)for(var b=this.K;b<this.R;b++)this.a[b]=a?Math.floor(256*Math.random()):32};f.T=function(a,b,c){switch(b){case "refresh":return this.H[b]=c,c.onclick=function(a){return function(){sb(a);Qa(a)}}(this),!0}return!1};
f.ba=function(a,b,c,d){this.a=a;this.K=b;this.pa=c-b+1;this.R=this.K+this.pa;d&&(this.s=d,Ra(d,56832,56832,this,this.S),Q(d,56832,56832,this,this.Ib));this.reset(!0)};function rb(a,b,c,d,e){a.J=void 0!==b?b:a.$;a.sa=void 0!==c?c:a.ea;a.g=a.J*a.sa;a.R=a.K+a.g;a.Z=void 0!==d?d:0;a.fa=void 0!==e?e:c;a.V=Math.floor(a.qa/a.J);a.X=Math.floor(a.ra/a.fa)}f.ca=function(){this.A.focus()};
f.La=function(a){this.M=a;600==this.M?(rb(this,this.$,this.ea,3,25),1024==this.g&&this.s&&(this.v=this.R+this.g-1,Q(this.s,this.v,this.v,this,this.Eb))):(this.l("updated video model: "+this.M),rb(this,64,32));sb(this);Qa(this)};f.ia=function(a,b){if(a&&!this.C.N&&J(this)){if(this.C.N=!0,this.u=O(b,"debugger"),this.b=O(b,"keyboard"))this.b.T("canvas","keyDown",this.A),this.b.T("canvas","keyPress",this.A),this.b.T("canvas","keyUp",this.A)}else!a&&this.C.N&&(this.C.N=!1)};
f.W=function(){this.B||(this.B=Math.floor(this.o.width/16));this.D||(this.D=Math.floor(this.o.height/16));D.prototype.W.call(this)};f.S=function(a,b){var c=this.s.S(a);void 0!==b&&this.u&&U(this.u,this,a,b,this.u.Ya);this.s.a[a]=c&127|(Math.floor(ab(this.s)/8333)&1?128:0)};f.Ib=function(a,b){void 0!==b&&this.u&&U(this.u,this,a,b,this.u.Ya)};
f.Eb=function(a,b){if(void 0!==b){this.u&&U(this.u,this,a,b,this.u.Ya,!0);this.La(540);this.b&&this.b.La(542);a=this.s;b=a.J;var c=[],d=Sa(b,this.v,this.v,this,this.Eb);if(0<=d){c.push(b[d][0]);c.push(b[d][1]);b.splice(d,1);var e=65536,g=0;for(d=0;d<b.length;d++)e>b[d][0]&&(e=b[d][0]),g<b[d][1]&&(g=b[d][1]);c.push(e);c.push(g)}4==c.length&&(a.ea=c[2],a.fa=c[3])}};function sb(a){a.L=Array(a.g);for(var b=0;b<=a.g;b++)a.L[b]=-1}
function Qa(a){var b=0;if(a.C.N)for(;b<a.g;){var c=a.a[a.K+b];if(a.L[b]!=c){var d=Math.floor(b/a.J);if(d>=a.Z&&(d-=a.Z,d<a.fa)){var e=c*a.B;a.P.drawImage(a.o,e%a.o.width,Math.floor(e/a.o.width)*a.D,a.B,a.D,b%a.J*a.V,d*a.X,a.V,a.X)}a.L[b]=c}b++}}
z(function(){for(var a=G(document,"c1pjs","video"),b=0;b<a.length;b++){var c=a[b],d=H(c),e=document.createElement("canvas");if(void 0===e||!e.getContext){c.innerHTML="\x3cbr/\x3eMissing \x26lt;canvas\x26gt; support. Please try a newer web browser.";break}e.setAttribute("class","c1pjs-canvas");e.setAttribute("width",d.screenWidth);e.setAttribute("height",d.screenHeight);e.setAttribute("contenteditable","true");e.setAttribute("autocapitalize","off");e.setAttribute("autocorrect","off");e.style.backgroundColor=
d.screenColor;e.style.height="auto";0<=(window?window.navigator.userAgent:"").indexOf("MSIE")&&(e.style.height=(c.clientWidth*d.screenHeight/d.screenWidth|0)+"px",c.onresize=function(a,b,c,d){return function(){b.style.height=(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight));c.appendChild(e);var g=new Image,k=e.getContext("2d");e=new qb(d,e,k,g);g.onload=function(a){return function(){a.W()}}(e,d.charSet);g.src=d.charSet;F(e,c)}});
function tb(a){D.call(this,"C1PSerialPort",a);this.C.N=!1;this.D=a.demo;this.reset(!0)}p(tb,D);f=tb.prototype;f.reset=function(a){if(a||this.o!=ub){this.v=-1;this.A=0;this.g="";if(this.D){a=1;if(this.kb){var b=this.kb.match(/\d+/);null!==b&&(a=parseInt(b[0],10))}this.g='10 PRINT "HELLO OSI #'+a+'"\n'}this.B=!0;this.o=vb}};f.start=function(){this.b&&this.D&&(nb(this.b," C\n\n",3E3),setTimeout(function(a){return function(){a.o=wb;nb(a.b,"LOAD\n")}}(this),12E3));this.D=!1};
f.T=function(a,b,c){var d=this;switch(b){case "listSerial":return this.H[b]=c,!0;case "loadSerial":return this.H[b]=c,c.onclick=function(){d.H.listSerial&&x(d.H.listSerial.value,function(a,b,c){xb(d,a,b,c)})},!0;case "mountSerial":return!y("Mobi")&&window&&"FileReader"in window?(this.H[b]=c,c.onchange=function(){var a=c.children[0];a.children[1].disabled=!a.children[0].files.length},c.onsubmit=function(a){var b=a.currentTarget[1].files[0],c=new FileReader;c.onload=function(){xb(d,b.name,c.result.toString(),
0)};c.readAsText(b);return!1}):c.parentNode.removeChild(c),!0}return!1};f.ba=function(a,b,c,d){this.a=a;this.M=b;this.K=c-b+1;this.J=this.M+this.K;if(this.s=d)Ra(d,b,c,this,this.S),Q(d,b,c,this,this.Hb);this.W()};f.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.U=b,this.b=O(b,"keyboard"),this.u=O(b,"debugger"))};
function xb(a,b,c,d){if(c){a.A=0;a.g=c;a.B=!0;a.o=vb;if(-1!==b.indexOf(".json",b.length-5))try{d="";var e=eval("("+c+")").bytes;for(c=0;c<e.length;c++)d+=String.fromCharCode(e[c]);a.g=d;a.B=!1}catch(g){a.l('Error processing file "'+b+'": '+g.message);return}a.U&&a.b&&a.s.C.na?(a.l("auto-loading "+b),a.s.ca(),"."!=a.g.charAt(0)?(a.o=wb,nb(a.b,"NEW\nLOAD\n")):(a.o=ub,a.U.reset(!0),nb(a.b,"ML"))):a.l(b+" ready to load")}else a.l('Error loading file "'+b+'" ('+d+")")}
f.S=function(a,b){void 0!==b&&(a&1?yb(this):this.g&&!this.A&&yb(this))};f.Hb=function(a,b){void 0!==b&&this.u&&U(this.u,this,a,b,this.u.Je,!0)};function yb(a){if(void 0!==a.g){a.v=-1;if(a.A<a.g.length){var b=a.g.charCodeAt(a.A++)&255;a.B&&10==b&&(b=13);a.v=b}else a.g="",a.A=0,a.o==wb&&a.b&&nb(a.b," \nRUN\n"),a.o=vb;for(b=a.M+0;b<a.J;b+=2)a.a[b]=0<=a.v?zb:Ab;for(b=a.M+1;b<a.J;b+=2)a.a[b]=0<=a.v?a.v:0}}var Ab=0,zb=1,vb=0,wb=1,ub=2;
z(function(){for(var a=G(document,"c1pjs","serial"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new tb(d);F(d,c)}});function Bb(a){D.call(this,"C1PDiskController",a);this.C.N=!1;this.reset(!0)}p(Bb,D);f=Bb.prototype;f.reset=function(a){Cb(this);this.b=-1;a&&(this.g=[],this.g[0]={Re:0,lb:40,Mb:!0,Ba:20,ma:0,Aa:-1,Qa:[]})};
function Cb(a){a.K={I:64,read:function(){},update:function(a){return function(b){void 0!==b&&(this.I=b);a.B.I&4||V(a,0,this)}}(a)};a.o={I:255,read:function(){this.update()},update:function(a){return function(b){void 0===b?b=a.o.I:Db(a,b,a.A.I);b=(b|190)&-2;if(0<=a.b&&a.g[a.b].Qa.length){var c=a.g[a.b];c.Mb&&(b&=-33);c.ma||(b&=-3);10>=--c.Ba&&(0<c.Ba?(b&=-129,Eb(a)):(c.Ba=100,0<=a.b&&(a.g[a.b].Aa=0,Fb(a))))}this.I=b;a.B.I&4&&V(a,0,this)}}(a)};a.B={I:0,read:function(){},update:function(a){return function(b){void 0!==
b&&(this.I=b&-193);V(a,1,this);a.o.update();a.K.update()}}(a)};a.L={I:255,read:function(){},update:function(a){return function(b){void 0!==b&&(this.I=b);a.D.I&4||V(a,2,this)}}(a)};a.A={I:255,read:function(){},update:function(a){return function(b){void 0===b?b=a.A.I:Db(a,a.o.I,b);if(0<=a.b&&a.b<a.g.length){var c=a.g[a.b];c.Qa.length&&a.A.I&8&&!(b&8)&&(b&4?c.ma--:c.ma++,a.u&&M(a.u,a.u.Da)&&a.u.message("stepping "+(b&4?"down":"up")+" to track "+c.ma),c.ma>=c.lb&&(c.ma=c.lb),0>c.ma&&(c.ma=0),c.Ba=20,
a.o.update(a.o.I|128),Eb(a))}this.I=b;a.D.I&4&&V(a,2,this)}}(a)};a.D={I:0,read:function(){},update:function(a){return function(b){void 0!==b&&(this.I=b&-193);V(a,3,this);a.A.update();a.L.update()}}(a)};a.P={I:0,read:function(){},update:function(a){return function(b){void 0!==b&&(3==(b&3)&&(a.v.I=14),this.I=b);a.v.update()}}(a)};a.v={I:14,read:function(){},update:function(a){return function(b){void 0===b&&(b=a.v.I);b&=-2;0<=a.b&&0<=a.g[a.b].Aa&&(b|=1);this.I=b;V(a,16,this)}}(a)};a.J={I:0,read:function(a){return function(){Fb(a)}}(a),
update:function(a){return function(b){void 0!==b&&(this.I=b);V(a,17,this)}}(a)};a.R={I:0,read:function(){},update:function(){return function(){}}(a)}}
f.T=function(a,b,c){switch(b){case "listDisk":return this.H[b]=c,!0;case "loadDisk":return this.H[b]=c,c.onclick=function(a){return function(){if(a.H.listDisk){var b=a.H.listDisk.value,c=b;".json"!=b.substr(b.length-5)&&(c="http://"+window.location.host+"/api/v1/dump?disk\x3d"+b);a.l("loading  "+pa(b)+"...");x(c,function(b,c,d){Gb(a,b,c,d)})}}}(this),!0}return!1};f.ba=function(a,b,c,d){this.a=a;this.M=b;if(this.s=d)Ra(d,b,c,this,this.S),Q(d,b,c,this,this.Fb);this.W()};
f.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.u=O(b,"debugger"))};
function Gb(a,b,c,d){if(d)a.l("disk load error ("+d+")");else{d=[];a.l("mounting "+b+"...");try{if(d=eval("("+c+")"),d.length)if(d[0].length){var e=d[0];if(void 0===e[0].trackNum)a.l("data error: "+e[0]);else if(a.g[0]){for(c=0;c<e.length;c++){var g,k=e[c],l=k.sectors;if(void 0===(g=k.trackNum)||void 0===l)throw Error("track "+c+" missing data");g!=c&&B("track "+g+" out of order (expected "+c+")");d=[];var h;if(g){Hb(d,k,"trackSig");Ib(d,k);W(d,k,"trackType");for(var m=0;m<l.length;m++){var n=l[m];
var t=n.sectorData;W(d,n,"sectorSig");W(d,n,"sectorNum");W(d,n,"sectorPages");for(h=0;h<t.length;h++)d.push(t[h]);Hb(d,n,"sectorEndSig")}}else for(n=l[0],t=n.sectorData,W(d,k,"trackLoad",2),W(d,n,"sectorPages"),h=0;h<t.length;h++)d.push(t[h]);e[g].Db=d;a.u&&M(a.u,a.u.Da)&&a.u.message("track "+g+": "+d.length+" bytes")}a.g[0].Qa=e;a.l("mount of "+b+" complete")}else a.l("no available drives")}else a.l("no tracks: "+b);else a.l("no data: "+b)}catch(da){a.l("disk data error: "+da.message)}}}
function Ib(a,b){b=b.trackNum;if(void 0===b)throw Error("missing bcd value: trackNum");a.push(Math.floor(b/10)<<4|b%10)}function W(a,b,c,d){b=b[c];if(void 0===b)throw Error("missing binary value: "+c);2==d&&a.push(b>>8&255);a.push(b&255)}function Hb(a,b,c){b=b[c];if(void 0===b)throw Error("missing signature: "+c);for(c=0;c<b.length;c++)a.push(b.charCodeAt(c))}
function Jb(a,b,c){b&=63;16>b?b&=3:32>b&&(b&=17);switch(b){case 0:a=a.B.I&4?a.o:a.K;break;case 1:a=a.B;break;case 2:a=a.D.I&4?a.A:a.L;break;case 3:a=a.D;break;case 16:a=c?a.P:a.v;break;case 17:a=a.J;break;default:a=a.R}return a}f.S=function(a,b){if(void 0!==b){var c=Jb(this,a-this.M,!1);this.u&&U(this.u,this,a,b,this.u.Da,!1,c.Cb);c.read()}};
f.Fb=function(a,b){if(void 0!==b){var c=this.s.S(a),d=Jb(this,a-this.M,!0);if(this.u&&M(this.u,this.u.Da|this.u.jb)&&(U(this.u,this,a,b,this.u.Da,!0,d.Cb),d.Kb))for(a=128,b=d.I^c;b&&a;)b&a&&this.u.message("  changed "+d.Cb+"."+d.Kb[a]+" to "+(c&a?"1":"0")),a>>=1;d.update(c)}};function Db(a,b,c){var d=-1;void 0!==b&&void 0!==c&&(d=0,c&32||(d|=2),a.o.I&64||(d|=1));a.b!=d&&(a.b=d,a.v.update())}function Eb(a){0<=a.b&&(a.g[a.b].Aa=-1,a.J.update(255),a.v.update())}
function Fb(a){if(0<=a.b){var b=a.g[a.b];var c=b.Qa[b.ma];void 0!==c&&(0<=b.Aa&&b.Aa<c.Db.length?(b.Ba=100,b=c.Db[b.Aa++],a.J.update(b),a.v.update()):(b.Ba=10,Eb(a)))}}function V(a,b,c){a.s.a[b+a.M]=c.I}z(function(){for(var a=G(document,"c1pjs","disk"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new Bb(d);F(d,c)}});
function Kb(a){D.call(this,"C1PDebugger",a);this.u=this;this.L=-1;this.ta=0;this.eb=null;this.Ra=!1;this.ha=0;this.oa=[];this.va=[];this.xa=[];this.Ja=0;this.wa=[];this.B=[];this.jb=1;this.ya=16;this.Ya=32;this.Da=64;this.Je=128;this.la=this.Z=0;this.Pa={port:1,kbd:16,video:32,disk:64,serial:128};this.Na=28;this.Za=56;this.Fa="ADC AND ASL BCC BCS BEQ BIT BMI BNE BPL BRK BVC BVS CLC CLD CLI CLV CMP CPX CPY DEC DEX DEY EOR INC INX INY JMP JSR LDA LDX LDY LSR NOP ORA PHA PHP PLA PLP ROL ROR RTI RTS SBC SEC SED SEI STA STX STY TAX TAY TSX TXA TXS TYA SIM .DB".split(" ");
this.X=["HLT","MSG"];Lb(this,!0);this.ga=[[10],[34,1,this.D],[this.Za,1],[],[],[34,1,this.b],[2,1,this.b],[],[36],[34,1,this.v],[2,0,this.P],[],[],[34,2,this.O],[2,2,this.O],[],[9,1,this.da],[34,1,this.J],[],[],[],[34,1,this.g],[2,1,this.g],[],[13],[34,2,this.A],[],[],[],[34,2,this.o],[2,2,this.o],[],[this.Na,2,this.Ma],[1,1,this.D],[],[],[6,1,this.b],[1,1,this.b],[39,1,this.b],[],[38],[1,1,this.v],[39,0,this.P],[],[6,2,this.O],[1,2,this.O],[39,2,this.O],[],[7,1,this.da],[1,1,this.J],[],[],[],[1,
1,this.g],[39,1,this.g],[],[44],[1,2,this.A],[],[],[],[1,2,this.o],[39,2,this.o],[],[41],[23,1,this.D],[],[],[],[23,1,this.b],[32,1,this.b],[],[35],[23,1,this.v],[32,0,this.P],[],[27,2,this.Ma],[23,2,this.O],[32,2,this.O],[],[11,1,this.da],[23,1,this.J],[],[],[],[23,1,this.g],[32,1,this.g],[],[15],[23,2,this.A],[],[],[],[23,2,this.o],[32,2,this.o],[],[42],[0,1,this.D],[],[],[],[0,1,this.b],[40,1,this.b],[],[37],[0,1,this.v],[40,0,this.P],[],[27,2,this.ib],[0,2,this.O],[40,2,this.O],[],[12,1,this.da],
[0,1,this.J],[],[],[],[0,1,this.g],[40,1,this.g],[],[46],[0,2,this.A],[],[],[],[0,2,this.o],[40,2,this.o],[],[],[47,1,this.D],[],[],[49,1,this.b],[47,1,this.b],[48,1,this.b],[],[22],[],[53],[],[49,2,this.O],[47,2,this.O],[48,2,this.O],[],[3,1,this.da],[47,1,this.J],[],[],[49,1,this.g],[47,1,this.g],[48,1,this.V],[],[55],[47,2,this.A],[54],[],[],[47,2,this.o],[],[],[31,1,this.v],[29,1,this.D],[30,1,this.v],[],[31,1,this.b],[29,1,this.b],[30,1,this.b],[],[51],[29,1,this.v],[50],[],[31,2,this.O],[29,
2,this.O],[30,2,this.O],[],[4,1,this.da],[29,1,this.J],[],[],[31,1,this.g],[29,1,this.g],[30,1,this.V],[],[16],[29,2,this.A],[52],[],[31,2,this.o],[29,2,this.o],[30,2,this.A],[],[19,1,this.v],[17,1,this.D],[],[],[19,1,this.b],[17,1,this.b],[20,1,this.b],[],[26],[17,1,this.v],[21],[],[19,2,this.O],[17,2,this.O],[20,2,this.O],[],[8,1,this.da],[17,1,this.J],[],[],[],[17,1,this.g],[20,1,this.g],[],[14],[17,2,this.A],[],[],[],[17,2,this.o],[20,2,this.o],[],[18,1,this.v],[43,1,this.D],[],[],[18,1,this.b],
[43,1,this.b],[24,1,this.b],[],[25],[43,1,this.v],[33],[],[18,2,this.O],[43,2,this.O],[24,2,this.O],[],[5,1,this.da],[43,1,this.J],[],[],[],[43,1,this.g],[24,1,this.g],[],[45],[43,2,this.A],[],[],[],[43,2,this.o],[24,2,this.o],[]]}p(Kb,D);f=Kb.prototype;
f.T=function(a,b,c){var d=this;switch(b){case "debugInput":return this.R=this.H[b]=c,this.R.focus(),c.onkeypress=function(a,c){return function(d){13==d.keyCode&&(b=c.value,c.value="",Mb(a,b))}}(this,c),!0;case "debugEnter":return this.H[b]=c,va(c,function(){return d.R?(b=d.R.value,Mb(d,b),!0):!1}),!0;case "step":return this.H[b]=c,va(c,function(a){var b=!1;K(d,!0)||(L(d,!0),b=d.step(a?1:0),L(d,!1));return b}),!0}return!1};
f.ba=function(a,b,c){this.a=a;this.M=b;this.ra=c-b+1;this.Ca=this.M+this.ra;this.W()};f.ia=function(a,b){a&&!this.C.N&&(this.C.N=!0,this.s=O(b,"cpu"))};f.ca=function(){this.R.focus()};
function Lb(a,b){a.P=0;a.v=1;a.o=2;a.A=3;a.Ma=4;a.ib=5;a.g=6;a.V=7;a.D=8;a.J=9;a.O=10;a.b=11;a.da=a.Ma;var c="";if(b)for(a.ka="A #$nn $nnnn,X $nnnn,Y $nnnn ($nnnn) $nn,X $nn,Y ($nn,X) ($nn),Y $nnnn $nn".split(" "),b=0;b<a.ka.length;b++){var d=a.ka[b];c+="("+d.replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/nnnn/g,"[0-9A-F][0-9A-F][0-9A-F][0-9A-F]?").replace(/nn/g,"[0-9A-F][0-9A-F]?").replace(/\$/g,"\\$")+"|)"}else for(a.ka="A nn [nnnn+X] [nnnn+Y] nnnn [nnnn] [nn+X] [nn+Y] [[nn+X]] [[nn]+Y] [nnnn] [nn]".split(" "),
b=0;b<a.ka.length;b++)d=a.ka[b],c+="("+d.replace(/\[/g,"\\[").replace(/]/g,"\\]").replace(/nnnn/g,"[0-9A-F][0-9A-F][0-9A-F][0-9A-F]?").replace(/nn/g,"[0-9A-F][0-9A-F]?").replace(/\+/g,"\\+")+"|)";a.Le=new RegExp(c);a.Lb=[27,a.Na,9,7,11,12,3,4,8,5]}f.aa=function(){this.s.aa()};function U(a,b,c,d,e,g,k){(a.la&e)==e&&(e=a.s.S(c),a.message(b.id+"."+(g?"setByte":"getByte")+"("+w(c)+")"+(void 0!==d?" @"+w(d):"")+": "+(k?k+"\x3d":"")+u(e)))}f.message=function(a){this.l(a);$a(this.s)};f.Nb=function(){this.l("Type ? for list of debugger commands\n")};
f.ua=function(){if(!Nb(this))return!1;this.s.ua();return!0};f.step=function(a){if(!Nb(this))return!1;try{var b=this.s.step(a)}catch(c){b=void 0,La(this.s,c.stack||c.message)}void 0!==b&&this.L++;this.s.update(!0);this.update(!0);return b};f.update=function(a){this.ta=this.s.f;a||this.za?Ob(this):Pb(this)};function Nb(a){a.s&&J(a.s)&&!K(a.s)?(a=a.s,a.C.error?(a.l(a.toString()+" error"),a=!0):a=!1,a=!a):a=!1;return a}
f.reset=function(){var a;this.wa.length||(this.wa=Array(1E3));for(a=0;a<this.wa.length;a++)this.wa[a]=-1;this.B.length||(this.B=Array(256));for(a=0;a<this.B.length;a++)this.B[a]=[a,0];this.L&&this.update();this.L=0};f.start=function(){this.za||this.l("running")};f.stop=function(a,b){if(!this.za&&(this.l("stopped"),b)){var c=ta();this.l(c-a+"ms ("+b+" cycles)")}this.update();this.ca();this.za||(this.L=0);Qb(this,this.s.f)};function Rb(a,b){return a+(b<<24>>24)}
f.S=function(a){if(a>=this.M&&a<this.Ca){Ta(this.s,a);var b=this.a[this.M+a];b&=255}return b};function Sb(a,b,c){b<a.M||b>=a.Ca?a.l("invalid address: "+w(b)):(a.a[a.M+b]=c&255,Ua(a.s,b),a.s.update())}function Tb(a,b){X(a.oa,b,void 0)||a.oa.push(b);return!0}function X(a,b,c){for(var d=!1,e=0;e<a.length;e++)if(a[e]==b){c&&a.splice(e,1);d=!0;break}return d}function Ub(a,b){void 0!==b&&(Qb(a,a.K),Tb(a,b)&&(a.K=b))}function Qb(a,b){void 0!==a.K&&b==a.K&&X(a.oa,a.K,!0)&&(a.K=void 0);a.za=!1}
function Za(a,b,c,d){for(var e=!1,g=0;g<c.length;g++)if(c[g]==b){b!=a.K&&a.l("breakpoint hit: "+w(b)+" ("+d+")");e=!0;break}return e}
function Vb(a,b,c){var d=r(b,4),e=a.S(b++),g=void 0===e?0:e,k=a.ga[g],l=[],h=void 0===k[1]?0:k[1];do{d+=" "+r(g,2);if(!h--)break;g=a.S(b++);if(void 0===g)break;l.push(g)}while(1);void 0===k[0]&&(k=[57,1,a.v],l.push(e));d=(d+"        ").substr(0,15);d+=a.Fa[k[0]];var m=null;if(void 0!==k[2]){h=k[2];m=a.ka[h];if(1==k[1]&&h==a.da)m=m.replace(/nnnn/,r(Rb(b,g=l.pop()),4));else for(;l.length;)m=m.replace(/nn/,r(g=l.pop(),2));h==a.v&&1==k[1]&&32<=g&&128>g&&(m+=" ;'"+String.fromCharCode(g)+"'")}if(e==a.s.Za&&
(g<a.X.length&&(m=a.X[g]),g==a.s.Ke)){h=0;for(m='"';g=a.S(b++);)16>h?m+=String.fromCharCode(g):16==h&&(m+="\u2026"),h++;m+='"'}m&&(d+=" "+m);c&&(d=(d+"               ").substr(0,30),d+=";"+c.toString());a.$=b;return d}
function Y(a,b){var c=a.ta;if(void 0!==b){var d=16;"$"==b.charAt(0)?b=b.substr(1):"0x"==b.substr(0,2)?b=b.substr(2):"."==b.charAt(b.length-1)&&(d=10,b=b.substr(0,b.length-1));c=parseInt(b,d);isNaN(c)&&(a.l("invalid base-"+d+" address: "+b),c=void 0)}void 0!==c&&(c<a.M||c>=a.Ca)&&(a.l("address out of range: "+r(c)),c=void 0);return c}
function Wb(a,b){if("?"==b)a.l("\nfrequency commands:"),a.l("clear\tclear all frequency counts");else{var c=0;if(a.B)if("clear"==b){for(b=0;b<a.B.length;b++)a.B[b]=[b,0];a.l("frequency data cleared");c++}else if(void 0!==b)a.l("unknown frequency command: "+b),c++;else{var d=a.B.slice();d.sort(function(a,b){return b[1]-a[1]});for(b=0;b<d.length;b++){var e=d[b][0],g=d[b][1];g&&(a.l(a.Fa[a.ga[e][0]]+" ("+u(e)+"): "+g+" times"),c++)}}c||a.l("no frequency data available")}}
function Ob(a,b,c,d){var e=Y(a,b);if(void 0!==e){void 0===d&&(d=1);b=a.Ca;if(void 0!==c){b=Y(a,c);if(void 0===b||b<e)return;if(256<b-e){a.l("range too large");return}b++;d=-1}for(e!=a.ta&&a.l();d--&&e<b;)c=Vb(a,e,K(a,!1)||a.za?a.L:0),a.l(c),a.ta=e=a.$}}
function Pb(a,b){if(b&&"?"==b[1])a.l("\nregister commands:"),a.l("r to display all"),a.l("r [target\x3dvalue] to modify"),a.l("supported targets:"),a.l("A,X,Y,S,PC and flags C,Z,D,V,N");else{var c=!0;if(void 0!==b&&1<b.length){c=!1;var d=b[1],e=d.indexOf("\x3d");if(0<e)b=d.substr(e+1),d=d.substr(0,e);else if(2<b.length)b=b[2];else{a.l("missing value for "+b[1]);return}e=parseInt(b,16);if(isNaN(e)){a.l("invalid value: "+b);return}switch(d.toUpperCase()){case "A":a.s.h=e&255;break;case "X":a.s.w=e&
255;break;case "Y":a.s.F=e&255;break;case "C":a.s.c=e?256:0;break;case "Z":a.s.j=e?0:1;break;case "D":e?bb(a.s):cb(a.s);break;case "V":e?(d=a.s,d.v=0,d.A=128):(d=a.s,d.v=0,d.A=0);break;case "N":a.s.i=e?128:0;break;case "S":if(256!=(e&-256)){a.l("invalid stack pointer: "+b);return}a.s.G=e;break;case "PC":c=!0;a.s.f=e&65535;a.ta=a.s.f;break;default:a.l("unknown register: "+d);return}a.s.update()}a.l("A\x3d"+r(a.s.h,2)+" X\x3d"+r(a.s.w,2)+" Y\x3d"+r(a.s.F,2)+" P\x3d"+r(Xa(a.s),2)+" S\x3d"+r(a.s.G,4)+
" PC\x3d"+r(a.s.f,4));c&&Ob(a,r(a.ta=a.s.f,4))}}function Xb(a,b){b=void 0===b?1:parseInt(b,10);var c=1==b?0:1;ua(b,function(a){return function(){return L(a,!0)&&a.step(c)}}(a),function(a){return function(){L(a,!1)}}(a))}
function Mb(a,b){b.length||(a.Ra?(a.l("ended assemble @"+r(a.ha,4)),a.ta=a.ha,a.Ra=!1):a.eb&&(b=a.eb));if(J(a)&&!K(a,!0)&&0<b.length){a.Ra?b="a "+r(a.ha,4)+" "+b:1<b.length&&1!=b.indexOf(" ")&&(b=b.charAt(0).toLowerCase()+" "+b.substr(1));var c=b.split(" ");a.eb=c[0];switch(c[0].toLowerCase()){case "a":var d=Y(a,c[1]);if(void 0!==d)if(a.ha=d,void 0===c[2])a.l("begin assemble @"+w(a.ha)),a.Ra=!0,a.s.update();else{b=c[2];var e=c[3];c=a.ha;d=[];if(void 0!==b){var g;b=b.toUpperCase();"?"==b.charAt(b.length-
1)&&(e="?",b=b.substr(0,b.length-1));for(g=0;g<a.Fa.length&&b!=a.Fa[g];g++);g==a.Fa.length&&(a.l("unknown operation: "+b),g=-1);var k="",l;if(0<=g&&void 0!==e)if(k=e.toUpperCase(),"?"==k){for(e=l=0;e<a.ga.length;e++)a.ga[e][0]===g&&(l||a.l("supported opcodes:"),a.l("     "+r(e,2)+": "+b+(void 0!==a.ga[e][2]?" "+a.ka[a.ga[e][2]]:"")),l++);g=-1}else if(l=k.match(a.Le),null!==l&&l[0]==k){for(e=1;e<l.length;e++)if(l[e]==k)if(void 0===h)var h=e-1;else{a.l("too many operand matches (both "+a.ka[h]+" and "+
a.ka[e-1]+")");g=-1;break}h==a.Ma&&0>a.Lb.indexOf(g)&&(h=a.O);h==a.ib&&27!=g&&(h=a.O)}else a.l("unknown operand: "+k),g=-1;if(0<=g){l=-1;for(e=0;e<a.ga.length;e++)if(a.ga[e][0]===g&&a.ga[e][2]===h)if(0>l)l=e;else{a.l("too many instruction matches (both "+u(l)+" and "+u(e)+")");l=-2;break}if(0<=l){if(d.push(l),void 0!==h)if(b=a.ga[l][1],k=k.match(/[0-9A-F]+/),null!==k)for(k=parseInt(k[0],16),1==b&&h==a.da&&(k-=c+2,-128>k||127<k)&&(a.l("branch out of range ("+k+")"),d=[],b=0),e=0;e<b;e++)d.push(k&255),
k>>>=8;else b&&a.l("instruction missing "+b+" bytes")}else a.l("unknown instruction: "+b+" "+k+"")}}h=d;if(h.length){for(c=0;c<h.length;c++)Sb(a,a.ha+c,h[c]);a.l(Vb(a,a.ha));a.ha+=h.length}}break;case "b":h=c[1];c=c[2];if(void 0===h||"?"==h)a.l("\nbreakpoint commands:"),a.l("bp [a]\tset exec breakpoint at [a]"),a.l("br [a]\tset read breakpoint at [a]"),a.l("bw [a]\tset write breakpoint at [a]"),a.l("bc [a]\tclear breakpoint at [a]"),a.l("bl\tlist all breakpoints");else if(void 0===c&&1<h.length&&
(c=h.substr(1),h=h.charAt(0)),"l"==h){h=0;d=a.oa;for(c=0;c<d.length;c++)a.l("breakpoint enabled: "+w(d[c])+" (exec)"),h++;d=a.va;for(c=0;c<d.length;c++)a.l("breakpoint enabled: "+w(d[c])+" (read)"),h++;d=a.xa;for(c=0;c<d.length;c++)a.l("breakpoint enabled: "+w(d[c])+" (write)"),h++;h||a.l("no breakpoints")}else void 0===c?a.l("missing breakpoint address"):"c"==h&&"*"==c?(a.oa=[],a.va=[],a.xa=[],a.l("all breakpoints cleared")):(c=Y(a,c),void 0!==c&&("p"==h?Tb(a,c)?a.l("breakpoint enabled: "+w(c)+" (exec)"):
a.l("breakpoint not set: "+w(c)):"c"==h?X(a.oa,c,!0)?a.l("breakpoint cleared: "+w(c)+" (exec)"):X(a.va,c,!0)?a.l("breakpoint cleared: "+w(c)+" (read)"):X(a.xa,c,!0)?a.l("breakpoint cleared: "+w(c)+" (write)"):a.l("breakpoint missing: "+w(c)):"r"==h?(X(a.va,c,void 0)||a.va.push(c),a.l("breakpoint enabled: "+w(c)+" (read)")):"w"==h?(X(a.xa,c,void 0)||a.xa.push(c),a.l("breakpoint enabled: "+w(c)+" (write)")):a.l("unknown breakpoint command: "+h)));break;case "d":h=c[1];d=c[2];if("?"==h)a.l("\ndump commands:"),
a.l("d [a] [#]    dump # lines of memory");else if(h=Y(a,h),void 0!==h){c=0;void 0!==d&&("l"==d.charAt(0)&&(d=d.substr(1)),c=parseInt(d,10));c||(c=1);for(d=0;d<c;d++){k=b="";e=h;for(g=0;8>g&&h<a.Ca;g++)l=a.S(h),void 0===l&&(l=0),b+=r(l,2)+" ",k+=32<=l&&127>l?String.fromCharCode(l):".",h++;a.l(r(e,4)+" "+b+k)}a.ta=h}break;case "e":h=c[1];if(void 0===h)a.l("missing address");else if(h=Y(a,h),void 0!==h)for(d=2;d<c.length;d++)b=parseInt(c[d],16),Sb(a,h++,b);break;case "f":Wb(a,c[1]);break;case "g":h=
c[1];void 0!==h&&Ub(a,Y(a,h));a.ua()||a.s.ca();break;case "h":a.aa();break;case "o":if(void 0===c[1]||"?"==c[1])a.l("\noption commands:"),a.l("max\trun at maximum speed"),a.l("fast\trun faster (up to "+a.s.Ea+"Mhz)"),a.l("slow\trun at normal speed (1Mhz)"),a.l("classic\tuse classic operand syntax"),a.l("modern\tuse modern operand syntax"),a.l("msg\tenable message categories");else switch(h=c[1],h){case "slow":P(a.s,a.s.Oa);break;case "fast":P(a.s,a.s.Me);break;case "max":P(a.s,a.s.Ne);break;case "classic":Lb(a,
!0);a.l("classic syntax enabled");break;case "modern":Lb(a,!1);a.l("modern syntax enabled");break;case "msg":h=0;void 0!==c[2]&&("all"==c[2]?h=255:void 0!==a.Pa[c[2]]&&(h=a.Pa[c[2]]),h&&("on"==c[3]?a.la|=h:"off"==c[3]&&(a.la&=~h)));for(d in a.Pa)if(void 0===c[2]||"all"==c[2]||c[2]==d)h=a.Pa[d],a.l(d+" messages: "+(a.la&h?"on":"off"));break;default:a.l("unknown option: "+h)}break;case "p":k=c[1];h=10;c=a.Ja;d=a.wa;if(void 0!==d){b=void 0===k?a.Ob:parseInt(k,10);void 0===b&&(b=10);b>d.length&&(a.l("note: only "+
d.length+" available"),b=d.length);void 0!==k&&(a.cb=0,a.l(b+" instructions earlier:"));k=a.cb?a.cb:1;c-=b;for(0>c&&(c=d.length-1);h&&c!=a.Ja;){e=d[c];if(0>e)break;a.l(Vb(a,e,k++));++c==d.length&&(c=0);h--;b--}a.Ob=b;a.cb=k}10==h&&a.l("no history available");break;case "r":Pb(a,c);break;case "s":a.S(a.s.f)==a.s.Na?(Ub(a,a.s.f+3),a.za=!0,a.ua()||a.s.ca()):Xb(a);break;case "t":Xb(a,c[1]);break;case "u":Ob(a,c[1],c[2],8);break;case "?":case "help":a.l("\ncommands:\n?\thelp\na [#]\tassemble\nb [#]\tbreakpoint\nd [#]\tdump memory\ne [#]\tedit memory\nf\tdump frequencies\ng [#]\trun to [#]\nh\thalt\no\toptions\np [#]\tdump history\nr\tdump/edit registers\ns\tstep over instruction\nt [#]\tstep instruction(s)\nu [#]\tunassemble");
a.l("note: frequency and history commands operate only when breakpoints are set");break;default:a.l("unknown command: "+b)}}}z(function(){for(var a=G(document,"c1pjs","debugger"),b=0;b<a.length;b++){var c=a[b],d=H(c);d=new Kb(d);F(d,c)}});function Z(a,b){D.call(this,"C1PComputer",a);this.Y=b}p(Z,D);Z.prototype.reset=function(a){var b=null,c;for(c in this.Y)for(var d=0;d<this.Y[c].length;d++){var e=this.Y[c][d];e&&e.reset&&(e.reset(),"cpu"==c&&(b=e))}b&&(b.update(),a&&b.ua())};
Z.prototype.start=function(){for(var a in this.Y)if("cpu"!=a)for(var b=0;b<this.Y[a].length;b++){var c=this.Y[a][b];c&&c.start&&c.start()}};Z.prototype.stop=function(a,b){for(var c in this.Y)if("cpu"!=c)for(var d=0;d<this.Y[c].length;d++){var e=this.Y[c][d];e&&e.stop&&e.stop(a,b)}};Z.prototype.T=function(a,b,c){switch(b){case "reset":return this.H[b]=c,c.onclick=function(a){return function(){a.reset()}}(this),!0}return!1};function O(a,b){return a.Y[b]?a.Y[b][0]:null}
function Yb(a){var b=null,c;for(c in a.Y)for(var d=0;d<a.Y[c].length;d++){var e=a.Y[c][d];if(e){if(!J(e)){J(e,function(a){return function(){Yb(a)}}(a));return}"cpu"==c?b=e:e.ia&&e.ia(!0,a)}}a.W();a.l("C1Pjs v1.50.0\nCopyright \u00a9 2012-2017 Jeff Parsons \x3cJeff@pcjs.org\x3e");b&&b.ia(!0,a)}
z(function(){for(var a=G(document,"c1pjs","computer"),b=0;b<a.length;b++){for(var c=a[b],d=H(c),e,g={},k,l=0,h=0,m=0;m<d.modules.length;m++){var n=d.modules[m];if(!m){if("cpu"!=n.type)break;l=n.start;h=n.end;k=Array(h+1-l);for(e=l;e<k.length;e++)k[e]=0}if(e=Ea(n.refID,d.id)){var t=n.type;void 0===g[t]&&(g[t]=[]);g[t].push(e);e.ba&&void 0!==n.start&&e.ba(k,n.start,n.end,g.cpu[0])}else{B('no component for \x3cmodule refid\x3d"'+n.refID+'"\x3e');return}}if(void 0===k){B('\x3cmodule type\x3d"cpu"\x3e definition must appear first in the \x3ccomputer\x3e specification');
break}if(e=Ea("debugger",d.id))g["debugger"]=[e],e.ba&&e.ba(k,l,h,g.cpu[0]);l=new Z(d,g);if(h=Ea("panel",d.id))if(g.panel=[h],h.H.print){e=void 0;d=d.id;g=[];d&&(d=0<(e=d.indexOf("."))?d.substr(0,e+1):"");for(e=0;e<E.length;e++)m=E[e],d&&m.id.indexOf(d)||g.push(m);d=g;for(g=0;g<d.length;g++)e=d[g],e!=h&&(e.Va=h.Va,e.print=h.print,e.l=h.l)}F(l,c);Yb(l)}});var Zb=0;
function $b(a,b,c,d,e,g){e("Loading "+a+"...");x(a,function(k,l,h){h?(l||(l="unable to load "+a+" ("+h+")"),g(l,null)):ac(l,a,b,c,d,e,g)})}
function ac(a,b,c,d,e,g,k){function l(a,g){if(g)k(g,null);else{c&&(N[c]&&b&&(N[c][b]=a),(g=b)&&0>g.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(g=window.location.pathname+g),d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{",d+='url:"'+g+'"}',"object"==typeof resources&&(g=null),d=d.replace(/\$/g,"$$$$"),a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms\x3d'"+d+"'":"")+(g?' url\x3d"'+g+'"':"")));e||(a=a.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,
"$1C1Pjs$2"),a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1c1pjs$2"));g=null;if("\x3c"==a.charAt(0))try{e||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(g=new window.ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a)):g=(new window.DOMParser).parseFromString(a,"text/xml")}catch(n){g=null,a=n.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);k(a,g)}}a?e?bc(a,g,l):l(a,null):k("no data"+(b?" for file: "+
b:""),null)}
function bc(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");x(e,function(g,k,l){if(l||!k)c(a,"unable to resolve XML reference: "+d[0]+" ("+l+")");else{if(g=d[3])if(l=k.match(new RegExp("\x3c"+d[1]+"[^\x3e]*\x3e"))){for(var h=l[0],m,n=/( [a-z]+=)(['"])(.*?)\2/gi;m=n.exec(g);)h=0>h.toLowerCase().indexOf(m[1].toLowerCase())?h.replace("\x3e",m[0]+"\x3e"):h.replace(new RegExp(m[1]+"(['\"])(.*?)\\1"),m[0]);l[0]!=h&&(k=k.replace(l[0],h))}else{c(a,"missing \x3c"+
d[1]+"\x3e in "+e);return}k=k.replace(/<\?xml[^>]*>[\r\n]*/,"");a=a.replace(d[0],k);bc(a,b,c)}})}else c(a,null)}
function cc(a,b,c){function d(a){if(void 0===k){var b=g&&G(g,"machine-warning");k=b&&b[0]||g}k&&(k.innerHTML=ra(a))}function e(a){d("Error: "+a);l&&(--Zb||C(!0));l=!1}var g,k,l=!0;Zb++;N[a]={};try{if(g=document.getElementById(a)){var h;if("object"==typeof resources&&(h=resources.css)){var m=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";n.styleSheet?n.styleSheet.cssText=h:n.appendChild(document.createTextNode(h));m.appendChild(n)}c||(c=
"/versions/c1pjs/1.50.0/components.xsl");h=function(h,k){k?$b(c,null,null,!1,d,function(h,l){l?(N[a]&&c&&(N[a][c]=h),d("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window?(l=k.transformNode(l))?(g.outerHTML=l,--Zb||C(!0)):e("transformNodeToObject failed"):document.implementation&&document.implementation.createDocument?(h=new XSLTProcessor,h.importStylesheet(l),(l=h.transformToFragment(k,document))?g.parentNode?(g.parentNode.replaceChild(l,g),--Zb||C(!0)):e("invalid machine element: "+
a):e("transformToFragment failed")):e("unable to transform XML: unsupported browser")):e(h)}):e(h)};"\x3c"!=b.charAt(0)?$b(b,a,void 0,!0,d,h):ac(b,null,a,void 0,!1,d,h)}else e("missing machine element: "+a)}catch(t){e(t.message)}return l}window.embedC1P=function(a,b,c){C(!1);return cc(a,b,c)};
window.commandMachine=function(a,b,c,d,e,g){if("script"==e){d=!1;c+=".machine";if(!g)delete I[c],d=!0;else if("string"==typeof g&&!I[c]){d=!0;e=I;for(var k=c,l=g.length,h=[],m=[],n="",t=null,da=0;da<l;da++){var v=g[da];if('"'==v||"'"==v)t&&v!=t?n+=v:(t?t=null:t=v,n&&(m.push(n),n=""));else{if(!t){if("\r"==v||"\n"==v)v=";";if(" "==v||"\t"==v||";"==v){n&&(m.push(n),n="");";"==v&&m.length&&(h.push(m),m=[]);continue}}n+=v}}n&&m.push(n);m.length&&h.push(m);e[k]=h;Ga(c)||(d=!1)}return d?(b&&(a.disabled=
!0),!0):!1}if(d&&(k=Fa(d,c+".machine"))&&(l=k.exports)&&(l=l[e]))return l.call(k,g)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+g+"')");return!1};window.enableEvents=C;window.sendEvent=Aa;})()
//# sourceMappingURL=c1p.js.map
